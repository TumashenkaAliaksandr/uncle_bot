{% extends 'index.html' %}
{% load static %}


{% block content %}

    <div class="player-container mx-auto mt-4 p-4">
        <div class="row justify-content-center">
            <div class="col-12 col-sm-5 text-center">
                <div class="cover mb-3">
                    {% if current_track.cover %}
                        <img id="trackCover" src="{{ current_track.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞"
                             class="img-fluid rounded">
                    {% else %}
                        <img id="trackCover" src="{% static 'botapp/static/img/no_images.png' %}" alt="–û–±–ª–æ–∂–∫–∞"
                             class="img-fluid rounded">
                    {% endif %}
                </div>
                <div class="track-info mb-3">
                    <h2 id="trackTitle" class="h5">ùÑû {{ current_track.title }}</h2>
                    <p id="trackAlbum" class="">üíΩ –ê–ª—å–±–æ–º: {{ current_track.album.name }}</p>
                </div>
            </div>
            <div class="col-12 col-sm-7">
                <p class="margin-chinazes">üé• –ú—É–∑—ã–∫–∞ –¥–ª—è –∫–∏–Ω–æ.</p>
{#                <p class="margin-files">üé¨ –ú—ã –≤–ª–∞–¥–µ–µ–º –æ–≥—Ä–æ–º–Ω–æ–π –±–∞–∑–æ–π —Ç—Ä–µ–∫–æ–≤ –∏ –æ—Ç–∫—Ä—ã—Ç—ã –∫ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É –≤ –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏–∏ ü§ù</p>#}
                <p class="margin-citate">üì° –ü–æ—Å—Ç—É–ø–∏–ª —Å–∏–≥–Ω–∞–ª –æ—Ç –ö–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –û—Å–ª–∞ - —Å–∏–≥–Ω–∞–ª N72 - –∞–º–∞ –º–∞–º–∞ –±–∞–Ω–∫–∏ ...</p>

                <div class="advantages-block">
                    <p class="margin-emodzi">üìå</p>
                    <ul class="advantages-list">
                        <li class="advantage-item">
                              <span class="icon-movie melodrama">
                                <img src="{% static 'botapp/static/svg/supawork-9b19f8dafa184001b81d98a83fa5ec41.webp' %}"/>
                              </span>
                            <span class="advantage-text">–ú–µ–ª–æ–¥—Ä–∞–º—ã</span>
                        </li>
                        <li class="advantage-item">
                           <span class="icon-movie melodrama">
                                <img src="{% static 'botapp/static/svg/supawork-76ea4d5abd5d420f91cd155341ab605e.webp' %}"/>
                          </span>
                            <span class="advantage-text">–¢—Ä–∏–ª–ª–µ—Ä—ã</span>
                        </li>
                        <li class="advantage-item">
                          <span class="icon-movie action">
                              <span class="icon-movie melodrama">
                                <img src="{% static 'botapp/static/svg/supawork-31000ea70e79421bab70459f4c270c0a.webp' %}"/>
                              </span>
                          </span>
                            <span class="advantage-text">–ë–æ–µ–≤–∏–∫–∏</span>
                        </li>
                        <li class="advantage-item">
                          <span class="icon-movie tarantino">
                                <span class="icon-movie melodrama">
                                <img src="{% static 'botapp/static/svg/supawork-7f73670fa4fd4c029654dd5643b56d1a.webp' %}"/>
                              </span>
                          </span>
                            <span class="advantage-text">–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</span>
                        </li>
                    </ul>
                </div>

                <!-- –°–µ–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á—ë—Ç–∞ -->
                <div class="countdown-container text-center my-4">
                    <h3>{{ countdown.name|default:"–û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç" }}</h3>
                    <div id="countdown" style="font-size: 2em; font-weight: bold; color: #ff4d4d;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>

                {#            <div class="ufo-container">#}
                {#                <img src="{% static 'botapp/static/svg/ufo.svg' %}" alt="UFO Icon"/>#}
                {#            </div>#}

                <a href="#" class="ufo-link" target="_blank" rel="noopener noreferrer"
                   aria-label="–ó–∞–ø—Ä—ã–≥–Ω–∏ –≤ –¥–µ–ª–∏–∂–∞–Ω—Å">
                    <div class="ufo-container">
                        <img src="{% static 'botapp/static/svg/ufo.svg' %}" alt="UFO Icon"/>
                        <span class="ufo-tooltip">üëΩ –ó–∞–ø—Ä—ã–≥–Ω–∏ –≤ –¥–µ–ª–∏–∂–∞–Ω—Å..</span>
                    </div>
                </a>


                <audio id="audioPlayer" src="{{ current_track.audio_file.url }}" preload="auto"
                       class="w-100 mb-3"></audio>
                <canvas id="visualizer" width="100%" height="80"></canvas>
                <div class="controls d-flex justify-content-center my-3 flex-wrap gap-3">
                    <button id="prevBtn" class="btn btn-outline-light btn-sm" aria-label="Previous">
                        <!-- –ò–∫–æ–Ω–∫–∞ Previous -->
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                            <polygon points="19 20 9 12 19 4 19 20"></polygon>
                            <line x1="5" y1="19" x2="5" y2="5"></line>
                        </svg>
                    </button>
                    <button id="playPauseBtn" class="btn btn-outline-light btn-sm" aria-label="Play/Pause">
                        <!-- –ò–∫–æ–Ω–∫–∞ Play (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                        <svg id="playIcon" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        <!-- –ò–∫–æ–Ω–∫–∞ Pause (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                        <svg id="pauseIcon" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" style="display:none;">
                            <rect x="6" y="4" width="4" height="16"></rect>
                            <rect x="14" y="4" width="4" height="16"></rect>
                        </svg>
                    </button>

                    <button id="nextBtn" class="btn btn-outline-light btn-sm" aria-label="Next">
                        <!-- –ò–∫–æ–Ω–∫–∞ Next -->
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                            <polygon points="5 4 15 12 5 20 5 4"></polygon>
                            <line x1="19" y1="5" x2="19" y2="19"></line>
                        </svg>
                    </button>

                    <button id="loopBtn" class="btn btn-outline-light btn-sm" aria-label="Loop">
                        <!-- –ò–∫–æ–Ω–∫–∞ Loop -->
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                            <polyline points="17 1 21 5 17 9"></polyline>
                            <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                            <polyline points="7 23 3 19 7 15"></polyline>
                            <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                        </svg>
                    </button>

                    <button id="shuffleBtn" class="btn btn-outline-light btn-sm" aria-label="Shuffle">
                        <!-- –ò–∫–æ–Ω–∫–∞ Shuffle -->
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                             stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                            <polyline points="16 3 21 3 21 8"></polyline>
                            <line x1="4" y1="20" x2="21" y2="3"></line>
                            <polyline points="21 16 21 21 16 21"></polyline>
                            <line x1="15" y1="15" x2="21" y2="21"></line>
                            <line x1="4" y1="4" x2="9" y2="9"></line>
                        </svg>
                    </button>
                </div>

                <div class="progress-container d-flex align-items-center gap-2 mb-3">
                    <span id="currentTime">0:00</span>

                    <svg class="progress-svg flex-grow-1" viewBox="0 0 300 20" xmlns="http://www.w3.org/2000/svg"
                         aria-hidden="true" role="img">
                        <path class="progress-track" d="M10 10 Q 50 0, 90 10 T 170 10 T 270 10" stroke="#444"
                              stroke-width="6" fill="none"/>
                        <path class="progress-bar" d="M10 10 Q 50 0, 90 10 T 170 10 T 270 10" stroke="#ffeb3b"
                              stroke-width="6" fill="none" stroke-linecap="round"/>
                    </svg>

                    <span id="duration">3:45</span>
                </div>

                <div class="volume-container d-flex align-items-center gap-2 mb-3">
                    <svg class="volume-svg" viewBox="0 0 300 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"
                         role="img">
                        <path class="volume-track" d="M10 10 Q 50 0, 90 10 T 170 10 T 270 10" stroke="#444"
                              stroke-width="6"
                              fill="none"/>
                        <path class="volume-bar" d="M10 10 Q 50 0, 90 10 T 170 10 T 270 10" stroke="#ede69d"
                              stroke-width="6" fill="none" stroke-linecap="round"/>
                        <circle class="volume-thumb" cx="10" cy="10" r="10" fill="#ede69d"
                                filter="drop-shadow(0 0 6px #ede69d)"/>
                    </svg>
                    <span id="volumeIcon">üîä</span>
                </div>

               <div class="track-list-wrapper position-relative bg-secondary bg-opacity-25 rounded p-2"
                 style="overflow-x: auto; white-space: nowrap; -ms-overflow-style: none; scrollbar-width: none;">
                <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å —ç–º–æ–¥–∑–∏ / —Å–∏–º–≤–æ–ª–æ–º –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
                <div class="scroll-hint position-absolute"
                     style="right: 10px; top: 70%; transform: translateY(-50%); pointer-events: none; user-select: none; font-size: 1.5rem; color: #555;">
                    üëâ
                </div>

                <ul id="trackList" class="list-unstyled d-flex flex-nowrap gap-2 justify-content-start"
                    style="width: max-content;">
                    {% for track in tracks %}
                        <li data-id="{{ track.id }}" data-url="{{ track.audio_file.url }}"
                            class="d-flex align-items-center gap-2 p-2 rounded {% if track.id == current_track.id %} active bg-success bg-opacity-25{% endif %}"
                            style="cursor:pointer; white-space: normal;">
                            {% if track.cover %}
                                <img src="{{ track.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞" class="mini-cover rounded">
                            {% else %}
                                <img src="{% static 'botapp/static/img/no_images.png' %}" alt="–û–±–ª–æ–∂–∫–∞"
                                     class="mini-cover rounded">
                            {% endif %}
                            <span class="text-truncate" style="max-width: 150px;">{{ track.title }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            </div>
        </div>
        <a href="#" class="omuamua-link" target="_blank" rel="noopener noreferrer"
           aria-label="–ì–¥–µ –Ω–µ –±—ã–ª..">
            <div class="omuamua-container">
                <img src="{% static 'botapp/static/svg/omuamua_ufo.svg' %}" alt="Oumuamua UFO Icon"/>
                <span class="ufo-tooltip">‚òÑÔ∏è –ê—Å—Ç–µ—Ä–æ–∏–¥ –ö–∞—Ä—Ç–æ—à–∫–∞</span>
                <span class="particle1"></span>
                <span class="particle2"></span>
                <span class="particle3"></span>
            </div>
        </a>

        <div class="comet comet1" role="img" aria-label="–ö–æ–º–µ—Ç–∞"></div>
        <div class="comet comet2" role="img" aria-label="–ö–æ–º–µ—Ç–∞"></div>
        <div class="comet comet3" role="img" aria-label="–ö–æ–º–µ—Ç–∞"></div>

        <div class="animated-stars">
            <svg style="display:none;" xmlns="http://www.w3.org/2000/svg">
                <symbol id="star" viewBox="0 0 22 22">
                    <path fill="whitesmoke" stroke="whitesmoke" stroke-width="0.4"
                          d="M12 2 L15 9 L22 9 L16 14 L18 21 L12 17 L6 21 L8 14 L2 9 L9 9 Z"/>
                </symbol>
            </svg>
        </div>

        <div id="cosmic-wind-overlay"
             style="position: fixed; top:0; left:0; width:100vw; height:100vh; pointer-events:none; overflow:hidden; z-index:9999; opacity:0; transition: opacity 2s ease-in-out;">
            <svg viewBox="0 0 800 200" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"
                 style="width: 100%; height: 100%;">
                <defs>
                    <linearGradient id="grad1" x1="0" x2="1" y1="0" y2="0">
                        <stop offset="0%" stop-color="rgba(255,255,255,0.4)"/>
                        <stop offset="50%" stop-color="rgba(255,255,255,0.1)"/>
                        <stop offset="100%" stop-color="rgba(255,255,255,0.4)"/>
                    </linearGradient>
                </defs>

                <g class="wind-glitch" stroke="url(#grad1)" stroke-width="4" stroke-linecap="round">

                    <line x1="0" y1="40" x2="200" y2="40"/>
                    <line x1="250" y1="80" x2="450" y2="80"/>
                    <line x1="500" y1="120" x2="700" y2="120"/>
                    <line x1="750" y1="160" x2="880" y2="160"/>

                    <line x1="50" y1="35" x2="50" y2="45"/>
                    <line x1="160" y1="35" x2="160" y2="45"/>
                    <line x1="300" y1="75" x2="300" y2="85"/>
                    <line x1="520" y1="115" x2="520" y2="125"/>
                    <line x1="740" y1="155" x2="740" y2="165"/>

                </g>

                <style>
                    .wind-glitch {
                        animation: glitchMove 6s ease-in-out infinite alternate;
                        opacity: 1;
                        will-change: transform, opacity;
                    }

                    @keyframes glitchMove {
                        0% {
                            opacity: 0.3;
                            transform: translateX(0);
                        }
                        50% {
                            opacity: 0.6;
                            transform: translateX(20px);
                        }
                        100% {
                            opacity: 0.3;
                            transform: translateX(0);
                        }
                    }
                </style>

            </svg>
        </div>


    </div>

{% endblock %}
