{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üíø –î–Ø–î–Ø–ü–ª–µ–µ—Ä (ÔπôÀì ‚Äçüéß ÀíÔπö)</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π CSS -->
    <link rel="stylesheet" href="{% static 'botapp/static/css/player.css' %}">
    <!-- –§–∞–≤–∏–∫–æ–Ω–∫–∞ -->
    <link rel="icon" type="image/png" href="{% static 'botapp/static/img/favicon.jpg' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<section>
  <div class="theme-switcher position-absolute top-0 end-0 m-3">
      <!-- –ó–¥–µ—Å—å —Å–∞–º –ø–ª–µ–µ—Ä –∏–ª–∏ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <button id="themeToggle" class="btn btn-outline-light">
      <span class="icon">üåó</span>
      <span class="text">–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</span>
    </button>
  </div>
</section>



<div class="player-container mx-auto mt-4 p-4">
    <div class="row justify-content-center">
        <div class="col-12 col-sm-5 text-center">
            <div class="cover mb-3">
                {% if current_track.cover %}
                    <img id="trackCover" src="{{ current_track.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞" class="img-fluid rounded">
                {% else %}
                    <img id="trackCover" src="{% static 'botapp/static/img/no_images.png' %}" alt="–û–±–ª–æ–∂–∫–∞"
                         class="img-fluid rounded">
                {% endif %}
            </div>
            <div class="track-info mb-3">
                <h2 id="trackTitle" class="h5">ùÑû {{ current_track.title }}</h2>
                <p id="trackAlbum" class="">üíΩ –ê–ª—å–±–æ–º: {{ current_track.album.name }}</p>
            </div>
        </div>
        <div class="col-12 col-sm-7">
        <h2 class="player-title">üë®üèª –î–Ø–î–Ø –ü–õ–ï–ï–†</h2>
        <p class="margin-files">üïí –í–µ—á–µ—Ä–æ–º —Å—Ä–µ–¥—É –ø–æ—Å–ª–µ –æ–±–µ–¥–∞ –î–Ø–î–Ø –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω.</p>
        <!-- –°–µ–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á—ë—Ç–∞ -->
            <div class="countdown-container text-center my-4">
                <h3>{{ countdown.name|default:"–û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç" }}</h3>
                <div id="countdown" style="font-size: 2em; font-weight: bold; color: #ff4d4d;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>

            <audio id="audioPlayer" src="{{ current_track.audio_file.url }}" preload="auto" class="w-100 mb-3"></audio>
            <canvas id="visualizer" width="100%" height="80"></canvas>
            <div class="controls d-flex justify-content-center my-3 flex-wrap gap-3">
  <button id="prevBtn" class="btn btn-outline-light btn-sm" aria-label="Previous">
    <!-- –ò–∫–æ–Ω–∫–∞ Previous -->
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <polygon points="19 20 9 12 19 4 19 20"></polygon>
      <line x1="5" y1="19" x2="5" y2="5"></line>
    </svg>
  </button>

  <button id="playPauseBtn" class="btn btn-outline-light btn-sm" aria-label="Play/Pause">
    <!-- –ò–∫–æ–Ω–∫–∞ Play (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <svg id="playIcon" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <polygon points="5 3 19 12 5 21 5 3"></polygon>
    </svg>
    <!-- –ò–∫–æ–Ω–∫–∞ Pause (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <svg id="pauseIcon" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" style="display:none;">
      <rect x="6" y="4" width="4" height="16"></rect>
      <rect x="14" y="4" width="4" height="16"></rect>
    </svg>
  </button>

  <button id="nextBtn" class="btn btn-outline-light btn-sm" aria-label="Next">
    <!-- –ò–∫–æ–Ω–∫–∞ Next -->
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <polygon points="5 4 15 12 5 20 5 4"></polygon>
      <line x1="19" y1="5" x2="19" y2="19"></line>
    </svg>
  </button>

  <button id="loopBtn" class="btn btn-outline-light btn-sm" aria-label="Loop">
    <!-- –ò–∫–æ–Ω–∫–∞ Loop -->
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <polyline points="17 1 21 5 17 9"></polyline>
      <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
      <polyline points="7 23 3 19 7 15"></polyline>
      <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
    </svg>
  </button>

  <button id="shuffleBtn" class="btn btn-outline-light btn-sm" aria-label="Shuffle">
    <!-- –ò–∫–æ–Ω–∫–∞ Shuffle -->
    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <polyline points="16 3 21 3 21 8"></polyline>
      <line x1="4" y1="20" x2="21" y2="3"></line>
      <polyline points="21 16 21 21 16 21"></polyline>
      <line x1="15" y1="15" x2="21" y2="21"></line>
      <line x1="4" y1="4" x2="9" y2="9"></line>
    </svg>
  </button>
</div>

            <div class="progress-container d-flex align-items-center gap-2 mb-3">
                <span id="currentTime">0:00</span>
                <input type="range" id="progressBar" value="0" min="0" max="100" class="form-range flex-grow-1">
                <span id="duration">0:00</span>
            </div>
            <div class="volume-container d-flex align-items-center gap-2 mb-3">
                <input type="range" id="volumeBar" min="0" max="1" step="0.01" value="1" class="form-range w-50">
                <span id="volumeIcon">üîä</span>
            </div>
            <div class="track-list bg-secondary bg-opacity-25 rounded p-2" style="max-height: 200px; overflow-y: auto;">
                <ul id="trackList" class="list-unstyled d-flex flex-wrap gap-2 justify-content-start">
                    {% for track in tracks %}
                        <li data-id="{{ track.id }}"
                            class="d-flex align-items-center gap-2 p-2 rounded {% if track.id == current_track.id %}active bg-success bg-opacity-25{% endif %}"
                            style="cursor:pointer;">
                            {% if track.cover %}
                                <img src="{{ track.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞" class="mini-cover rounded">
                            {% else %}
                                <img src="{% static 'botapp/static/img/no_images.png' %}" alt="–û–±–ª–æ–∂–∫–∞"
                                     class="mini-cover rounded">
                            {% endif %}
                            <span class="text-truncate" style="max-width: 150px;">{{ track.title }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
<section class="conteiner">
    <div class="d-flex justify-content-center my-4">
        <a id="desperateButton"
           class="btn btn-danger btn-lg"
           href="https://t.me/–í–ê–®_–¢–ï–õ–ï–ì–†–ê–ú–ú" target="_blank"
           rel="noopener noreferrer">–ù–∞ –î–Ø–î–Æ! üë®üèª‚Äçüîß</a>
        <div id="clouds" class="cloud-cloud cloud1"></div>
        <div id="clouds" class="cloud-cloud cloud2"></div>
        <div class="ufo"></div>
    </div>
</section>

<div id="skyContainer">
    <div class="pulse-dot"
         style="width: 60px; height: 20px; top: 10%; left: 15%; background-color: #ff4d4d; animation-delay: 0s;"></div>
    <div class="pulse-dot"
         style="width: 15px; height: 15px; top: 30%; left: 40%; background-color: #4dff88; animation-delay: 0.5s;"></div>
    <div class="pulse-dot"
         style="width: 25px; height: 25px; top: 60%; left: 50%; background-color: #4d88ff; animation-delay: 1s;"></div>
    <div class="pulse-dot"
         style="width: 18px; height: 18px; top: 80%; left: 20%; background-color: #ffdb4d; animation-delay: 1.5s;"></div>
    <div class="pulse-dot"
         style="width: 22px; height: 22px; top: 50%; left: 85%; background-color: #ff4da6; animation-delay: 2s;"></div>
    <div class="pulse-dot"
         style="width: 20px; height: 20px; top: 10%; left: 15%; background-color: #ff4d4d; animation-delay: 0s;"></div>
    <div class="pulse-dot"
         style="width: 15px; height: 15px; top: 30%; left: 40%; background-color: #4dff88; animation-delay: 0.5s;"></div>
    <div class="pulse-dot"
         style="width: 25px; height: 25px; top: 60%; left: 70%; background-color: #4d88ff; animation-delay: 1s;"></div>
    <div class="pulse-dot"
         style="width: 18px; height: 18px; top: 40%; left: 20%; background-color: #ffdb4d; animation-delay: 1.5s;"></div>
    <div class="pulse-dot"
         style="width: 29px; height: 22px; top: 50%; left: 96%; background-color: #ff4da6; animation-delay: 2s;"></div>
    <!-- –î–æ–±–∞–≤—å—Ç–µ —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ -->
</div>


<footer class="text-center" style="font-size: 0.85rem; opacity: 0.5; margin-top: 2rem;">
  ¬© 2025 –î–Ø–î–Ø–ü–ª–µ–µ—Ä &mdash; by @ultavioletpartyeyes
</footer>


<script>
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è countdown.end_time –ø–µ—Ä–µ–¥–∞–Ω–∞ –∏–∑ –≤—å—é
  {% if countdown %}
    const endTime = new Date("{{ countdown.end_time|date:'Y-m-d\\TH:i:s' }}").getTime();

    function updateCountdown() {
      const now = new Date().getTime();
      const distance = endTime - now;

      if (distance < 0) {
        document.getElementById("countdown").innerHTML = "–í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ!";
        clearInterval(timer);
        return;
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      document.getElementById("countdown").innerHTML =
        days + " –¥–Ω " + hours + " —á " + minutes + " –º–∏–Ω " + seconds + " —Å–µ–∫";
    }

    updateCountdown();  // –ó–∞–ø—É—Å–∫ —Å—Ä–∞–∑—É
    const timer = setInterval(updateCountdown, 1000);  // –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
  {% else %}
    document.getElementById("countdown").innerHTML = "–û—Ç—Å—á—ë—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω";
  {% endif %}
</script>


<!-- Bootstrap JS Bundle (Popper + Bootstrap JS) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π JS -->
<script src="{% static 'botapp/static/js/player.js' %}"></script>
</body>
</html>
